{"name":"tmp.db","desc":"","tables":[{"name":"migration_v2","type":"table","comment":"","columns":[{"name":"migration_v2_id","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"file_name","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"migrate_time","type":"TEXT","nullable":false,"default":null,"comment":""}],"indexes":[{"name":"sqlite_autoindex_migration_v2_1","def":"UNIQUE (file_name)","table":"migration_v2","columns":["file_name"],"comment":""}],"constraints":[{"name":"migration_v2_id","type":"PRIMARY KEY","def":"PRIMARY KEY (migration_v2_id)","table":"migration_v2","referenced_table":null,"columns":["migration_v2_id"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_migration_v2_1","type":"UNIQUE","def":"UNIQUE (file_name)","table":"migration_v2","referenced_table":null,"columns":["file_name"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE migration_v2 (\n\tmigration_v2_id INTEGER PRIMARY KEY,\n\tfile_name TEXT NOT NULL,\n\tmigrate_time TEXT NOT NULL,\n\tUNIQUE(file_name)\n) STRICT"},{"name":"env","type":"table","comment":"","columns":[{"name":"env_id","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"name","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"comment","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"create_time","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"update_time","type":"TEXT","nullable":false,"default":null,"comment":""}],"indexes":[{"name":"sqlite_autoindex_env_1","def":"UNIQUE (name)","table":"env","columns":["name"],"comment":""}],"constraints":[{"name":"env_id","type":"PRIMARY KEY","def":"PRIMARY KEY (env_id)","table":"env","referenced_table":null,"columns":["env_id"],"referenced_columns":null,"comment":""},{"name":"sqlite_autoindex_env_1","type":"UNIQUE","def":"UNIQUE (name)","table":"env","referenced_table":null,"columns":["name"],"referenced_columns":null,"comment":""}],"triggers":[],"def":"CREATE TABLE env (\n    env_id INTEGER PRIMARY KEY,\n    name TEXT NOT NULL,\n    comment TEXT NOT NULL,\n    create_time TEXT NOT NULL,\n    update_time TEXT NOT NULL,\n    UNIQUE(name)\n) STRICT"},{"name":"env_var","type":"table","comment":"","columns":[{"name":"env_var_id","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"env_id","type":"INTEGER","nullable":false,"default":null,"comment":""},{"name":"name","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"comment","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"create_time","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"update_time","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"value","type":"TEXT","nullable":false,"default":null,"comment":""}],"indexes":[{"name":"ix_env_var_env_id","def":"CREATE INDEX ix_env_var_env_id ON env_var(env_id)","table":"env_var","columns":["env_id"],"comment":""},{"name":"sqlite_autoindex_env_var_1","def":"UNIQUE (env_id, name)","table":"env_var","columns":["env_id","name"],"comment":""}],"constraints":[{"name":"env_var_id","type":"PRIMARY KEY","def":"PRIMARY KEY (env_var_id)","table":"env_var","referenced_table":null,"columns":["env_var_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (env_id) REFERENCES env (env_id) ON UPDATE NO ACTION ON DELETE CASCADE MATCH NONE","table":"env_var","referenced_table":"env","columns":["env_id"],"referenced_columns":["env_id"],"comment":""},{"name":"sqlite_autoindex_env_var_1","type":"UNIQUE","def":"UNIQUE (env_id, name)","table":"env_var","referenced_table":null,"columns":["env_id","name"],"referenced_columns":null,"comment":""}],"triggers":[{"name":"tr_env_var_insert_check_unique_name","def":"CREATE TRIGGER tr_env_var_insert_check_unique_name\nBEFORE INSERT ON env_var\nFOR EACH ROW\nBEGIN\n    SELECT RAISE(FAIL, 'name already exists in env')\n    FROM vw_env_env_ref_env_var_unique_name\n    WHERE env_id = NEW.env_id AND name = NEW.name;\nEND","comment":""},{"name":"tr_env_var_update_check_unique_name","def":"CREATE TRIGGER tr_env_var_update_check_unique_name\nBEFORE UPDATE ON env_var\nFOR EACH ROW\nBEGIN\n    SELECT\n        CASE\n            WHEN OLD.env_id != NEW.env_id OR OLD.name != NEW.name THEN (\n                SELECT RAISE (FAIL, 'name already exists in env')\n                FROM vw_env_env_ref_env_var_unique_name\n                WHERE env_id = NEW.env_id AND name = NEW.name\n        )\n        END;\nEND","comment":""}],"def":"CREATE TABLE \"env_var\" (\n    env_var_id INTEGER PRIMARY KEY,\n    env_id INTEGER NOT NULL,\n    name TEXT NOT NULL,\n    comment TEXT NOT NULL,\n    create_time TEXT NOT NULL,\n    update_time TEXT NOT NULL,\n    value TEXT NOT NULL,\n    FOREIGN KEY (env_id) REFERENCES env(env_id) ON DELETE CASCADE,\n    UNIQUE(env_id, name)\n) STRICT"},{"name":"env_ref","type":"table","comment":"","columns":[{"name":"env_ref_id","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"env_id","type":"INTEGER","nullable":false,"default":null,"comment":""},{"name":"name","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"comment","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"create_time","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"update_time","type":"TEXT","nullable":false,"default":null,"comment":""},{"name":"env_var_id","type":"INTEGER","nullable":false,"default":null,"comment":""}],"indexes":[{"name":"ix_env_ref_env_var_id","def":"CREATE INDEX ix_env_ref_env_var_id ON env_ref(env_var_id)","table":"env_ref","columns":["env_var_id"],"comment":""},{"name":"ix_env_ref_env_id","def":"CREATE INDEX ix_env_ref_env_id ON env_ref(env_id)","table":"env_ref","columns":["env_id"],"comment":""},{"name":"sqlite_autoindex_env_ref_1","def":"UNIQUE (env_id, name)","table":"env_ref","columns":["env_id","name"],"comment":""}],"constraints":[{"name":"env_ref_id","type":"PRIMARY KEY","def":"PRIMARY KEY (env_ref_id)","table":"env_ref","referenced_table":null,"columns":["env_ref_id"],"referenced_columns":null,"comment":""},{"name":"- (Foreign key ID: 0)","type":"FOREIGN KEY","def":"FOREIGN KEY (env_var_id) REFERENCES env_var (env_var_id) ON UPDATE NO ACTION ON DELETE RESTRICT MATCH NONE","table":"env_ref","referenced_table":"env_var","columns":["env_var_id"],"referenced_columns":["env_var_id"],"comment":""},{"name":"- (Foreign key ID: 1)","type":"FOREIGN KEY","def":"FOREIGN KEY (env_id) REFERENCES env (env_id) ON UPDATE NO ACTION ON DELETE CASCADE MATCH NONE","table":"env_ref","referenced_table":"env","columns":["env_id"],"referenced_columns":["env_id"],"comment":""},{"name":"sqlite_autoindex_env_ref_1","type":"UNIQUE","def":"UNIQUE (env_id, name)","table":"env_ref","referenced_table":null,"columns":["env_id","name"],"referenced_columns":null,"comment":""}],"triggers":[{"name":"tr_env_ref_insert_check_unique_name","def":"CREATE TRIGGER tr_env_ref_insert_check_unique_name\nBEFORE INSERT ON env_ref\nFOR EACH ROW\nBEGIN\n    SELECT RAISE(FAIL, 'name already exists in env')\n    FROM vw_env_env_ref_env_var_unique_name\n    WHERE env_id = NEW.env_id AND name = NEW.name;\nEND","comment":""},{"name":"tr_env_ref_update_check_unique_name","def":"CREATE TRIGGER tr_env_ref_update_check_unique_name\nBEFORE UPDATE ON env_ref\nFOR EACH ROW\nBEGIN\n    SELECT\n        CASE\n            WHEN OLD.env_id != NEW.env_id OR OLD.name != NEW.name THEN (\n                SELECT RAISE (FAIL, 'name already exists in env')\n                FROM vw_env_env_ref_env_var_unique_name\n                WHERE env_id = NEW.env_id AND name = NEW.name\n        )\n        END;\nEND","comment":""}],"def":"CREATE TABLE \"env_ref\" (\n    env_ref_id INTEGER PRIMARY KEY,\n    env_id INTEGER NOT NULL,\n    name TEXT NOT NULL,\n    comment TEXT NOT NULL,\n    create_time TEXT NOT NULL,\n    update_time TEXT NOT NULL,\n    env_var_id INTEGER NOT NULL,\n    FOREIGN KEY (env_id) REFERENCES env(env_id) ON DELETE CASCADE,\n    FOREIGN KEY (env_var_id) REFERENCES \"env_var\"(env_var_id) ON DELETE RESTRICT,\n    UNIQUE(env_id, name)\n)"},{"name":"vw_env_env_ref_env_var_unique_name","type":"view","comment":"","columns":[{"name":"env_id","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"name","type":"TEXT","nullable":true,"default":null,"comment":""}],"indexes":[],"constraints":[],"triggers":[],"def":"CREATE VIEW vw_env_env_ref_env_var_unique_name AS\nSELECT e.env_id, er.name\nFROM env e JOIN env_ref er ON e.env_id = er.env_id\nUNION ALL\nSELECT e.env_id, ev.name\nFROM env e JOIN env_var ev ON e.env_id = ev.env_id","referenced_tables":["env","env_ref","env_var"]},{"name":"vw_env_ref_referenced_name","type":"view","comment":"","columns":[{"name":"env_ref_id","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"env_id","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"env_name","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"name","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"env_var_id","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"ref_var_name","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"ref_env_name","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"comment","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"create_time","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"update_time","type":"TEXT","nullable":true,"default":null,"comment":""}],"indexes":[],"constraints":[],"triggers":[],"def":"CREATE VIEW vw_env_ref_referenced_name AS\nSELECT\n    env_ref_id,\n    env_id,\n    (SELECT name FROM env WHERE env_id = env_ref.env_id) AS env_name,\n    name,\n    env_var_id,\n    (SELECT name FROM env_var WHERE env_var_id = env_ref.env_var_id) AS ref_var_name,\n    (SELECT env.name FROM env JOIN env_var ON env.env_id = env_var.env_id WHERE env_var.env_var_id = env_ref.env_var_id) AS ref_env_name,\n    comment,\n    create_time,\n    update_time\nFROM env_ref","referenced_tables":["env","env_var","env_ref"]},{"name":"vw_env_var_referenced_name","type":"view","comment":"","columns":[{"name":"env_var_id","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"env_id","type":"INTEGER","nullable":true,"default":null,"comment":""},{"name":"env_name","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"name","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"value","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"comment","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"create_time","type":"TEXT","nullable":true,"default":null,"comment":""},{"name":"update_time","type":"TEXT","nullable":true,"default":null,"comment":""}],"indexes":[],"constraints":[],"triggers":[],"def":"CREATE VIEW vw_env_var_referenced_name AS\nSELECT\n    env_var_id,\n    env_id,\n\t(SELECT name FROM env WHERE env_id = env_var.env_id) AS env_name,\n    name,\n    value,\n    comment,\n    create_time,\n    update_time\nFROM env_var","referenced_tables":["env","env_var"]}],"relations":[{"table":"env_var","columns":["env_id"],"cardinality":"Zero or more","parent_table":"env","parent_columns":["env_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (env_id) REFERENCES env (env_id) ON UPDATE NO ACTION ON DELETE CASCADE MATCH NONE","virtual":false},{"table":"env_ref","columns":["env_var_id"],"cardinality":"Zero or more","parent_table":"env_var","parent_columns":["env_var_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (env_var_id) REFERENCES env_var (env_var_id) ON UPDATE NO ACTION ON DELETE RESTRICT MATCH NONE","virtual":false},{"table":"env_ref","columns":["env_id"],"cardinality":"Zero or more","parent_table":"env","parent_columns":["env_id"],"parent_cardinality":"Exactly one","def":"FOREIGN KEY (env_id) REFERENCES env (env_id) ON UPDATE NO ACTION ON DELETE CASCADE MATCH NONE","virtual":false}],"functions":null,"driver":{"name":"sqlite","database_version":"3.45.1","meta":{}}}
